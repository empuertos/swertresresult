<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Embedded Google Sheet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --radius: 1rem;
      --shadow: 0 16px 40px -10px rgba(0, 0, 0, 0.15);
      --transition: 0.35s ease;
      --bg: #0f111a;
      --card-bg: #1f2435;
      --accent: #6366f1;
      font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 2rem;
      background: linear-gradient(135deg,#0f111a 0%,#1f2435 100%);
      min-height: 100vh;
      color: #f0f5ff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      line-height: 1.45;
    }

    .embed-wrapper {
      position: relative;
      width: 100%;
      max-width: 1100px;
      /* 16:9 ratio fallback; sheet is tall so you can adjust if needed */
      aspect-ratio: 16 / 9;
      background: var(--card-bg);
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow);
      transition: transform var(--transition);
    }

    .embed-wrapper:focus-within {
      outline: 2px solid var(--accent);
    }

    .iframe-container {
      width: 100%;
      height: 100%;
      position: relative;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: 0;
      display: block;
      background: white; /* in case of slow load */
      border-radius: var(--radius);
      opacity: 0;
      transition: opacity 0.4s ease;
    }

    .loaded iframe {
      opacity: 1;
    }

    .spinner {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(15,17,26,.85);
      font-size: 0.9rem;
      flex-direction: column;
      gap: 0.5rem;
      color: #d1d9ff;
      padding: 1rem;
    }

    .spinner .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--accent);
      margin: 0 4px;
      animation: pulse 1s infinite ease-in-out;
    }

    .dots {
      display: flex;
      gap: 4px;
    }

    @keyframes pulse {
      0%,100% { transform: scale(1); opacity: .7; }
      50% { transform: scale(1.4); opacity: 1; }
    }

    .fallback {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,.6);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      text-align: center;
      padding: 1rem;
      font-size: .95rem;
      gap: .5rem;
    }

    .btn {
      background: var(--accent);
      color: white;
      padding: .55rem 1rem;
      border: none;
      border-radius: .5rem;
      cursor: pointer;
      font-weight: 600;
      font-size: .9rem;
      transition: background .25s;
      text-decoration: none;
    }
    .btn:hover { filter: brightness(1.1); }
    .small {
      font-size: 0.75rem;
      opacity: 0.85;
    }
  </style>
</head>
<body>
  <div class="embed-wrapper" aria-label="Google Sheet embed">
    <div class="iframe-container" id="embed">
      <div class="spinner" id="spinner" aria-live="polite">
        <div>Loading spreadsheetâ€¦</div>
        <div class="dots" aria-hidden="true">
          <div class="dot" style="animation-delay: 0s;"></div>
          <div class="dot" style="animation-delay: 0.2s;"></div>
          <div class="dot" style="animation-delay: 0.4s;"></div>
        </div>
        <div class="small">If it takes too long, you can <a class="btn" href="https://docs.google.com/spreadsheets/d/e/2PACX-1vQYsjd9JYHYMW-UQipV00EObQWZyER01Cj0LCOwwkq1TFlg0lBjmTmZVUFDXPvyb-y2zqXW2pzskL-5/pubhtml?gid=0&amp;single=true&amp;widget=true&amp;headers=false" target="_blank" rel="noopener">open in new tab</a></div>
      </div>
      <iframe
        id="sheetFrame"
        loading="lazy"
        src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQYsjd9JYHYMW-UQipV00EObQWZyER01Cj0LCOwwkq1TFlg0lBjmTmZVUFDXPvyb-y2zqXW2pzskL-5/pubhtml?gid=0&amp;single=true&amp;widget=true&amp;headers=false"
        title="Live Google Sheet"
        referrerpolicy="no-referrer"
        allow="clipboard-read; clipboard-write"
      ></iframe>
      <div class="fallback" id="fallback" hidden>
        <div>Unable to load the embedded spreadsheet.</div>
        <div>
          <a class="btn" href="https://docs.google.com/spreadsheets/d/e/2PACX-1vQYsjd9JYHYMW-UQipV00EObQWZyER01Cj0LCOwwkq1TFlg0lBjmTmZVUFDXPvyb-y2zqXW2pzskL-5/pubhtml?gid=0&amp;single=true&amp;widget=true&amp;headers=false" target="_blank" rel="noopener">
            Open Spreadsheet
          </a>
        </div>
      </div>
    </div>
  </div>

  <script>
    const iframe = document.getElementById('sheetFrame');
    const spinner = document.getElementById('spinner');
    const embed = document.getElementById('embed');
    const fallback = document.getElementById('fallback');

    let loaded = false;
    const timeout = setTimeout(() => {
      if (!loaded) {
        spinner.hidden = true;
        fallback.hidden = false;
      }
    }, 12000); // after 12s show fallback

    iframe.addEventListener('load', () => {
      loaded = true;
      clearTimeout(timeout);
      embed.parentElement.classList.add('loaded');
      spinner.style.opacity = '0';
      setTimeout(() => spinner.hidden = true, 500);
    });

    // Optional: auto-resize height if you want to adapt to content via postMessage
    // Note: Google Sheets in published mode doesn't reliably postHeight, so omitted.
  </script>
</body>
</html>
